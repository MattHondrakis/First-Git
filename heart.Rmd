---
title: "Heart"
author: "Matthew"
date: "1/6/2022"
output: 
  html_document:
    keep_md: true
    toc: true
    toc_float: true
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
library(tidyverse)
library(GGally)
theme_set(theme_bw())
heart <- read_csv("C:/Users/Matthew Hondrakis/Downloads/heart.csv")
heart <- heart %>%
  rename_all(tolower) %>%
  mutate(across(where(is.character), as.factor),
         heartdisease = as.factor(heartdisease),
         chestpaintype = recode(chestpaintype, TA = "Typical Angina", ATA = "Atypical Angina", 
                                NAP = "Non-Anginal Pain", ASY = "Anymptomatic"))
```

# Explore

## Sex
```{r}
heart %>%
  group_by(sex) %>%
  summarize(Percent = mean(heartdisease == 1)) %>%
  ggplot(aes(sex, Percent, fill = sex)) + geom_col()
```

## Max Heart rate
```{r}
heart %>%
  ggplot(aes(heartdisease, maxhr, group = heartdisease)) + geom_boxplot()
```

## Resting ECG
```{r}
heart %>%
  ggplot(aes(restingecg, fill = heartdisease)) + geom_bar(position = "dodge")

```

## Cholesterol 
```{r}
heart %>%
  filter(cholesterol != 0) %>%
  ggplot(aes(heartdisease, cholesterol, color = heartdisease)) + geom_boxplot() + 
  geom_jitter(width = 0.18, alpha = 0.2) + facet_wrap(~sex)

heart %>%
  filter(sex == "M", cholesterol < 10) %>%
  View()
```




